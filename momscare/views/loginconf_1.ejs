<html>
    <body>
        <form action="/users/login/password" method="POST" id="form" name="form" >
            email:
            <%if(email){%>
                <input type="email" name="email" value="<%= email %>" >
                

            <%}else{%>
                <input type="email" name="email" >

            
            <%}%>
            password:
            <input type="password" name="password">
            <canvas id="canvas" style="border: 1px; padding: 2px; background-image: url('../styles/login/back2.jpg');" width="100" height="35"></canvas>
            <input type="text" id="cpid" name="captcha">
            <button id="validate" onclick="capchamatch();">submit</button>
            
            <input type="hidden" name="c" id="check">
            
        </form>
        <button id="ref" onclick="capchaReload();"><img src="../styles/login/reload.png" width="32" height="33"></button>

        <script>

            var ca;
            function onPageloadFunc()
            {
                ca=capcha();
                
            }
            window.onload=onPageloadFunc();
    
            function capchaReload()
            {
                ca=capcha();
            }
    
            function capcha()
            {
                var num1=Math.floor(Math.random()*10);
                var num2=Math.floor(Math.random()*10);
                var num3=Math.floor(Math.random()*10);
    
                var arr1 = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];
                var arr2=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
    
                var i = Math.floor(Math.random()*26);
                var j = Math.floor(Math.random()*26);
    
    
                var alpha1 = arr1[i];
                var alpha2 = arr2[j];
    
                var array = [num1,num2,num3,alpha1,alpha2]
    
                var i1 = Math.floor(Math.random()*4);
                var i2 = Math.floor(Math.random()*4);
                var i3 = Math.floor(Math.random()*4);
                var i4 = Math.floor(Math.random()*4);
                var i5 = Math.floor(Math.random()*4);
    
    
                var ch1 = array[i1];
                var ch2 = array[i2];
                var ch3 = array[i3];
                var ch4 = array[i4];
                var ch5 = array[i5];
    
                var canvas = document.getElementById("canvas");
                var context = canvas.getContext("2d");
                context.font = "30px monospace";
    
                context.clearRect(0,0,canvas.width,canvas.height);
    
                context.fillText(ch1,9,20);
                context.fillText(ch2,24,26);
                context.fillText(ch3,36,20);
                context.fillText(ch4,50,22);
                context.fillText(ch5,64,24);
    
    
                console.log(ch1+""+ch2+""+ch3+""+ch4+""+ch5);
                return myCodeCapcha = ch1+""+ch2+""+ch3+""+ch4+""+ch5;
            }
    
            function capchamatch(){
                // document.print(myCodeCapcha);
                console.log(ca);
                var inputcapcha= document.getElementById("cpid").value;
                if(inputcapcha!==ca)
                {
                    document.getElementById('check').value=false;
                    return false;

                    
                    
                }
                else{
                    console.log("success")
                    document.getElementById('check').value=true;
                    return true;
                }
            }
        </script>
    </body>
</html>